<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE doc[
<!ENTITY mediaFilter SYSTEM "dplconfig/PVMediaFilter.xml">
]>

<DplConfig>
	<DataNode name="/mp/get" type="rest" location="http://m-tst-adlibpricevol02.advertising.aol.com:50003/media_properties">
		<Read uriSuffix="get" timeout="600" >
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Group name="filter" >
					<Parameter name="campaign_id" />
				</Group>
			</UriQueryParameters>
			&mediaFilter;
			<OnFailure forwardTo="/mp.campaign" forwardTranslatedParameters="false" />
		</Read>
	</DataNode>
	<DataNode name="/mp.campaign" type="rest" location="http://m-tst-adlibpricevol02.advertising.aol.com:50003/media_properties">
		<Read uriSuffix="get" timeout="600" >
			<TranslateParameters>
				<Parameter name="filter" valueTranslator="`echo -n %v | sed -ne 's/[Cc]ampaign_\?[Ii][Dd]~/campaign_id~/p'`" />
			</TranslateParameters>
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Parameter name="filter" />
			</UriQueryParameters>
		</Read>
	</DataNode>
	
	<!-- The dm name is a misnomer, its a daily cell dm and NOT hourly cell-->
	<DataNode name="/dc/get" type="rest" location="http://m-tst-adlibpricevol02.advertising.aol.com:50017/cell_hourly" >
		<Read uriSuffix="get" timeout="600" compression="none" >
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Group name="filter" >
					<Parameter name="campaign_id" />
				</Group>
			</UriQueryParameters>
			&mediaFilter;
			<OnFailure forwardTo="/dc.campaign" forwardTranslatedParameters="false" />
		</Read>
	</DataNode>
	<!-- The dm name is a misnomer, its a daily cell dm and NOT hourly cell-->
	<DataNode name="/dc.campaign" type="rest" location="http://m-tst-adlibpricevol02.advertising.aol.com:50017/cell_hourly">
		<Read uriSuffix="get" timeout="600" compression="none" >
			<TranslateParameters>
				<Parameter name="filter" valueTranslator="`echo -n %v | sed -ne 's/[Cc]ampaign_\?[Ii][Dd]~/campaign_id~/p'`" />
			</TranslateParameters>
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Parameter name="filter" />
			</UriQueryParameters>
		</Read>
	</DataNode>

	<DataNode name="/ctr/get" type="rest" location="http://m-tst-adlibpricevol02.advertising.aol.com:50051/ctr">
		<Read uriSuffix="get" timeout="600" compression="none" >
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Group name="filter" >
					<Parameter name="campaign_id" />
				</Group>
			</UriQueryParameters>
			&mediaFilter;
		</Read>
	</DataNode>

	<DataNode name="/cvr/get" type="rest" location="http://m-tst-adlibpricevol02.advertising.aol.com:50052/cvr">
		<Read uriSuffix="get" timeout="600" compression="none" >
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Group name="filter" >
					<Parameter name="campaign_id" />
				</Group>
			</UriQueryParameters>
			&mediaFilter;
		</Read>
	</DataNode>

	<DataNode name="/cfc/get" type="rest" location="http://localhost:50018/campaign_frequency_cap">
		<Read uriSuffix="get" timeout="600" >
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Group name="filter" >
					<Parameter name="campaign_id" />
				</Group>
			</UriQueryParameters>
			<TranslateParameters>
				<Parameter name="filter" valueTranslator="`echo -n %v | sed -e 's/CampaignID/campaign_id/p'`" /> 
				<Parameter name="campaign_id" valueTranslator="`echo -n %v | sed -nre 's/.*campaign_id~([^^]+).*/\1/p'`" valueSource="filter" />
				<Parameter name="scope_filter" valueTranslator="`echo -n %v | sed -nre 's/.*scope~([0-9]+).*/ || scope != \1/p'`" valueSource="filter" />
			</TranslateParameters>
			<StreamTransformers>
				<StreamTransformer path="./libValidateStreamTransformer.so" functionName="Validate" >
					<Parameter name="timeout" value="5.0" />
					<Parameter name="discardIf" value="false %v" valueSource="scope_filter" />
				</StreamTransformer>
			</StreamTransformers>
		</Read>
	</DataNode>

	<DataNode name="/mfc/get" type="rest" location="http://localhost:50013/media_frequency_cap">
		<Read uriSuffix="get" timeout="600" >
			<TranslateParameters>
				<Parameter name="filter" valueTranslator="`echo -n %v | sed -ne 's/MediaID/media_id/p'`" /> 
			</TranslateParameters>
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Parameter name="filter" />
			</UriQueryParameters>
		</Read>
	</DataNode>

	<DataNode name="/met/get" type="rest" location="http://localhost:50014/media_element_targeting">
		<Read uriSuffix="get" timeout="600" >
			<TranslateParameters>
				<Parameter name="filter" valueTranslator="`echo -n %v | sed -ne 's/MediaId/media_id/p'`" /> 
			</TranslateParameters>
			<UriQueryParameters>
				<Parameter name="targetApplicableTime" />
				<Parameter name="filter" />
			</UriQueryParameters>
		</Read>
	</DataNode>

	<DataNode name="/crv/get" type="rest" location="http://adl-campaignrevenuevector.vip.prod.root:50022/campaign_revenue_vector">
-->	<!-- header is:  campaign_id,unit_type,cost_per_unit,click_hard_target,action_hard_target,indexed_impressions,indexed_clicks,indexed_actions,cost_per_impression,cost_per_click,cost_per_action
 -->
		<Read uriSuffix="get" timeout="100">
			<TranslateParameters>
				<Parameter name="effectiveTime" translatedName="targetApplicableTime" />
      			<Parameter name="filterProperties" translatedName="filter" />
      			<Parameter name="filter" valueTranslator="`echo -n %v | sed -ne 's/.*\(campaign_id~[^^]\+\).*/\1/p'`" />
			</TranslateParameters>
   		 	<UriQueryParameters>
    			<Parameter name="filter" />
    			<Parameter name="targetApplicableTime" />
			</UriQueryParameters>
		</Read>
	</DataNode>

</DplConfig>
